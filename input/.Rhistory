source("C:/Users/tobia/OneDrive/Desktop/Project-celulares-y-tecnologia-scraping/scripts/03 - EDA/Graficos_Primer_Analisis.R")
source("~/.active-rstudio-document")
#------------------------------------------------------------Importamos los Archivos necesarios------------------------------------------------------------------
# 1. Definimos el directorio de entrada
input_dir <- "C:/Users/tobia/OneDrive/Desktop/Project-celulares-y-tecnologia-scraping/input"
# 2. Listamos todos los CSV en la carpeta
csv_files <- list.files(path = input_dir,
pattern = "\\.csv$",
full.names = TRUE)
# 3. Los leemos en una lista, nombrando cada elemento con el nombre del archivo (sin extensión)
tabla_list <- csv_files %>%
set_names(nm = tools::file_path_sans_ext(basename(.))) %>%
map(read_csv)
ls()
#------------------------------------------------------------Importamos los Archivos necesarios------------------------------------------------------------------
# 1. Directorio de entrada
input_dir <- "C:/Users/tobia/OneDrive/Desktop/Project-celulares-y-tecnologia-scraping/input"
# 2. Lectura de cada CSV
tabla_claro     <- read.csv(file.path(input_dir, "claro_celulares_base.csv"),
stringsAsFactors = FALSE)
tabla_personal  <- read.csv(file.path(input_dir, "personal_celulares_base.csv"),
stringsAsFactors = FALSE)
tabla_centrogar <- read.csv(file.path(input_dir, "cetrogar_celulares_base.csv"),
stringsAsFactors = FALSE)
tabla_completa  <- read.csv(file.path(input_dir, "celulares_todos_base.csv"),
stringsAsFactors = FALSE)
source("C:/Users/tobia/OneDrive/Desktop/Project-celulares-y-tecnologia-scraping/scripts/03 - EDA/EDA_v2.R")
print(marcasXmodelo)
# 4.2 -----   Barras Horizontales - Separado por Tiendas ---------------
# 1. Limpiamos espacios y quedamos con los sitios de interés
tabla_sep <- tabla_completa %>%
mutate(sitio = str_trim(sitio)) %>%
filter(sitio %in% c("Personal", "Claro", "Cetrogar"))
# 2. Contamos modelos por marca en total (suma sobre los 3 sitios)
total_por_marca <- tabla_sep %>%
count(marca, name = "total_modelos")
# 3. Identificamos las 3 marcas con más modelos
top3_marcas <- total_por_marca %>%
slice_max(order_by = total_modelos, n = 3) %>%
pull(marca)
# 4. Filtramos el dataset original para quedarnos sólo con esas 3 marcas
tabla_top3 <- tabla_sep %>%
filter(marca %in% top3_marcas)
# 5. Volvemos a contar por sitio y marca (ahora sólo top 3)
tabla_counts <- tabla_top3 %>%
count(marca, sitio, name = "cantidad") %>%
ungroup()
# 6. (Opcional) Si quieres un “Total” de las 3 marcas, puedes:
tabla_total <- tabla_counts %>%
group_by(marca) %>%
summarise(cantidad = sum(cantidad), .groups = "drop") %>%
mutate(sitio = "Total")
tabla_counts <- bind_rows(tabla_counts, tabla_total)
# 7. Definimos el orden de aparición de las marcas (y de los facet_wrap)
orden_global <- top3_marcas
niveles_sitio <- c("Personal", "Claro", "Cetrogar", "Total")
tabla_counts <- tabla_counts %>%
mutate(
marca = factor(marca, levels = orden_global),
sitio = factor(sitio, levels = niveles_sitio)
)
# 8. Graficamos
marcasXmodelo <- ggplot(tabla_counts, aes(x = cantidad, y = marca, fill = sitio)) +
geom_col(show.legend = FALSE, width = 0.7) +
geom_text(aes(label = cantidad), hjust = -0.1, size = 3) +
facet_wrap(~ sitio, scales = "free_x", nrow = 1) +
scale_fill_material_d() +
labs(
title = "Top 3 Marcas × Modelos",
x     = "Modelos (n)",
y     = NULL
) +
theme_minimal(base_size = 12) +
theme(
plot.title  = element_text(hjust = 0.5, size = 16, face = "bold"),
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text  = element_text(face = "bold")
) +
expand_limits(x = max(tabla_counts$cantidad) * 1.1)
print(marcasXmodelo)
source("C:/Users/tobia/OneDrive/Desktop/Project-celulares-y-tecnologia-scraping/scripts/03 - EDA/EDA_v2.R")
